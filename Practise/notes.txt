- For every round
  - Initialization Phase
    - System Initialization
    - Topology Establishment
  - Packet Sending and Forwarding
  - Packet Receiving at the Sink
  - Node Categorization Algorithm
- Heuristic Ranking Algorithm

- Initialization Phase
  - Preloading keys and other system parameters
    - Ku, Lr, Np, Ns
  - Topology Establishment
    - Sink(u) sends 2-tuple to its neighbors(v), <source,distance>
    - node u sets its distance dv+1 from v
    - node u pics one of many parents as its parent(Pu)
    - node u pics one random number(short ID) Ru between 0 and Np-1
    - finally node u sends Pu, Ru and all recorded parents to to sink

- Packet sending and forwarding
  - <Pu, {Ru, u, Cp MOD Ns, D, padu,0}Ku, padu,1>
  - padu,1 = log(Np) * (h-1) for a distance of h hops from sink node
  - log(Np) is added and chopped away at every receiving of packet
  - node v receives a packet as <Pv, {Rv,m'}k>

- Packet Receiving at the Sink
  - at first sink sets, u =0 and m = m'
  - sink node perform dec(Kv,m)
    - if dec failed for all nodes, means the packet is modified and dropped
    - if dec succeed then:
      - if dec(Kv, m) starts with <Rv,v>, means v is original sender of pkt
      - else means v is intermediate node. Then u=v and m = (trimming Rv from leftmost)

- Node Categorization Algorithm
  - For every round sink keeps track of
    - total pkts sent by u
    - seq no. of these pkts
    - no. of flips in seq no.
  - In the end of round sink calculates the dropping ratio for each node u
    - (total sent pkts - recv pkts) / total sent pkts
  - Based on dropping ratio, sink identifies sure and possibly droppers.
  - For this threshold theta introduced
